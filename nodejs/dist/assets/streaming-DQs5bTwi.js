import{h as i,a as b,H as l}from"./constants-6gU7-fjU.js";function x(n,e,r){let a;if(!e||!("children"in e))a=i(n,e,[]);else{const t=e.children;delete e.children,a=Array.isArray(t)?i(n,e,t):i(n,e,[t])}return a.key=r,a}var w=new TextEncoder,y=n=>new ReadableStream({async start(r){var u;const a=n instanceof Promise?await n:await n.toString(),t=typeof a=="object"?a:{},d=await b(a,l.BeforeStream,!0,t);r.enqueue(w.encode(d));let h=0;const o=[],m=s=>{o.push(s.catch(c=>(console.trace(c),"")).then(async c=>{var f;c=await b(c,l.BeforeStream,!0,t),(f=c.callbacks)==null||f.map(S=>S({phase:l.Stream,context:t})).filter(Boolean).forEach(m),h++,r.enqueue(w.encode(c))}))};for((u=d.callbacks)==null||u.map(s=>s({phase:l.Stream,context:t})).filter(Boolean).forEach(m);h!==o.length;)await Promise.all(o);r.close()}});export{x as j,y as r};
